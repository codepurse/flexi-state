{"version":3,"file":"index.umd.js","sources":["../src/index.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\n\r\nexport const createStore = (initializeStore, middleware = (store) => store) => {\r\n  let state = initializeStore(null);\r\n  let listeners = new Set();\r\n  let stateInitializer = initializeStore;\r\n\r\n  const getState = () => {\r\n    if (state === undefined) {\r\n      state = stateInitializer(null);\r\n      stateInitializer = null;\r\n    }\r\n    return state;\r\n  };\r\n\r\n  const setState = (newState) => {\r\n    const updatedState = deepMerge(state, newState);\r\n    if (shallowEqual(state, updatedState)) return;\r\n    state = updatedState;\r\n    listeners.forEach((listener) => listener(state));\r\n  };\r\n\r\n  const subscribe = (listener) => {\r\n    listeners.add(listener);\r\n    return () => {\r\n      listeners.delete(listener);\r\n    };\r\n  };\r\n\r\n  const actions = {};\r\n  for (const [key, action] of Object.entries(initializeStore(state))) {\r\n    if (typeof action === \"function\") {\r\n      actions[key] = (...args) => {\r\n        const updater = action(...args);\r\n        const newState = updater(state);\r\n        setState(newState);\r\n      };\r\n    }\r\n  }\r\n\r\n  return (selector = getState) => {\r\n    const [currentState, setCurrentState] = useState(selector(getState()));\r\n\r\n    useEffect(() => {\r\n      const listener = (newState) => {\r\n        const selectedState = selector(newState);\r\n        if (!shallowEqual(currentState, selectedState)) {\r\n          // Update state only if it has changed\r\n          setCurrentState(selectedState);\r\n        }\r\n      };\r\n\r\n      const unsubscribe = subscribe(listener);\r\n\r\n      // Clean up subscription\r\n      return () => {\r\n        unsubscribe();\r\n      };\r\n    }, [selector]);\r\n\r\n    return { ...currentState, ...actions, getState, setState, subscribe };\r\n  };\r\n};\r\n\r\nconst shallowEqual = (objA, objB) => {\r\n  if (objA === objB) return true;\r\n  if (\r\n    typeof objA !== \"object\" ||\r\n    objA === null ||\r\n    typeof objB !== \"object\" ||\r\n    objB === null\r\n  ) {\r\n    return false;\r\n  }\r\n\r\n  for (const key in objA) {\r\n    if (objA.hasOwnProperty(key)) {\r\n      if (!objB.hasOwnProperty(key) || objA[key] !== objB[key]) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  for (const key in objB) {\r\n    if (objB.hasOwnProperty(key) && !objA.hasOwnProperty(key)) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nconst deepMerge = (target, source) => {\r\n  const result = { ...target };\r\n  for (const key in source) {\r\n    if (typeof source[key] === \"object\" && source[key] !== null) {\r\n      result[key] = deepMerge(target[key] || {}, source[key]);\r\n    } else {\r\n      result[key] = source[key];\r\n    }\r\n  }\r\n  return result;\r\n};\r\n"],"names":["shallowEqual","objA","objB","key","hasOwnProperty","deepMerge","target","source","result","_extends","initializeStore","middleware","state","listeners","Set","stateInitializer","getState","undefined","setState","newState","updatedState","forEach","listener","subscribe","add","actions","_loop","_Object$entries$_i","_Object$entries","_i","action","apply","slice","call","arguments","updater","Object","entries","length","selector","_useState","useState","currentState","setCurrentState","useEffect","unsubscribe","selectedState"],"mappings":"0eAEa,IA8DPA,EAAe,SAACC,EAAMC,GAC1B,GAAID,IAASC,EAAM,OAAO,EAC1B,GACkB,iBAATD,GACE,OAATA,GACgB,iBAATC,GACE,OAATA,EAEA,OACF,EAEA,IAAK,IAAMC,KAAOF,EAChB,GAAIA,EAAKG,eAAeD,MACjBD,EAAKE,eAAeD,IAAQF,EAAKE,KAASD,EAAKC,IAClD,SAKN,IAAK,IAAMA,KAAOD,EAChB,GAAIA,EAAKE,eAAeD,KAASF,EAAKG,eAAeD,GACnD,OAAO,EAIX,OAAO,CACT,EAEME,EAAY,SAAZA,EAAaC,EAAQC,GACzB,IAAMC,EAAMC,EAAA,GAAQH,GACpB,IAAK,IAAMH,KAAOI,EAEdC,EAAOL,GADkB,iBAAhBI,EAAOJ,IAAqC,OAAhBI,EAAOJ,GAC9BE,EAAUC,EAAOH,IAAQ,CAAE,EAAEI,EAAOJ,IAEpCI,EAAOJ,GAGzB,OAAOK,CACT,gBApG2B,SAACE,EAAiBC,GA4B3C,IA3BA,IAAIC,EAAQF,EAAgB,MACxBG,EAAY,IAAIC,IAChBC,EAAmBL,EAEjBM,EAAW,WAKf,YAJcC,IAAVL,IACFA,EAAQG,EAAiB,MACzBA,EAAmB,MAEdH,CACT,EAEMM,EAAW,SAACC,GAChB,IAAMC,EAAef,EAAUO,EAAOO,GAClCnB,EAAaY,EAAOQ,KACxBR,EAAQQ,EACRP,EAAUQ,QAAQ,SAACC,GAAQ,OAAKA,EAASV,EAAM,GACjD,EAEMW,EAAY,SAACD,GAEjB,OADAT,EAAUW,IAAIF,GACP,WACLT,EAAgB,OAACS,EACnB,CACF,EAEMG,EAAU,GAAGC,EAAAA,WACd,IAAAC,EAAAC,EAAAC,GAAYC,EAAMH,EAAA,GACC,mBAAXG,IACTL,EAFWE,EAAEG,IAEE,WACb,IACMX,EADUW,EAAMC,WAAA,EAAA,GAAAC,MAAAC,KAAAC,WACLC,CAAQvB,GACzBM,EAASC,EACX,EAEJ,EARAU,EAAAD,EAAAA,EAA4BQ,OAAOC,QAAQ3B,EAAgBE,IAAOiB,EAAAD,EAAAU,OAAAT,IAAAH,IAUlE,OAAQa,SAAAA,QAAAA,IAAAA,IAAAA,EAAWvB,GACjB,IAAAwB,EAAwCC,EAAQA,SAACF,EAASvB,MAAnD0B,EAAYF,KAAEG,EAAeH,EAAA,GAmBpC,OAjBAI,EAASA,UAAC,WACR,IAQMC,EAActB,EARH,SAACJ,GAChB,IAAM2B,EAAgBP,EAASpB,GAC1BnB,EAAa0C,EAAcI,IAE9BH,EAAgBG,EAEpB,GAKA,OAAa,WACXD,GACF,CACF,EAAG,CAACN,IAEJ9B,EAAA,GAAYiC,EAAiBjB,EAAST,CAAAA,SAAAA,EAAUE,SAAAA,EAAUK,UAAAA,GAC5D,CACF"}