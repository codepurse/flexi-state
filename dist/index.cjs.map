{"version":3,"file":"index.cjs","sources":["../src/util/utils.js","../src/index.js"],"sourcesContent":["export const shallowEqual = (objA, objB) => {\r\n  if (objA === objB) return true;\r\n  if (\r\n    typeof objA !== \"object\" ||\r\n    objA === null ||\r\n    typeof objB !== \"object\" ||\r\n    objB === null\r\n  ) {\r\n    return false;\r\n  }\r\n\r\n  for (const key in objA) {\r\n    if (objA.hasOwnProperty(key)) {\r\n      if (!objB.hasOwnProperty(key) || objA[key] !== objB[key]) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  for (const key in objB) {\r\n    if (objB.hasOwnProperty(key) && !objA.hasOwnProperty(key)) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nexport const deepMerge = (target, source) => {\r\n  const result = { ...target };\r\n  for (const key in source) {\r\n    if (typeof source[key] === \"object\" && source[key] !== null) {\r\n      result[key] = deepMerge(target[key] || {}, source[key]);\r\n    } else {\r\n      result[key] = source[key];\r\n    }\r\n  }\r\n  return result;\r\n};\r\n","import { useEffect, useState } from \"react\";\nimport { deepMerge, shallowEqual } from \"./util/utils\";\n\nexport const createStore = (initializeStore, middleware = (store) => store) => {\n  let state = initializeStore(null);\n  let listeners = new Set();\n  let stateInitializer = initializeStore;\n\n  const getState = () => {\n    if (state === undefined) {\n      state = stateInitializer(null);\n      stateInitializer = null;\n    }\n    return state;\n  };\n\n  const setState = (newState) => {\n    const updatedState = deepMerge(state, newState);\n    if (shallowEqual(state, updatedState)) return;\n    state = updatedState;\n    listeners.forEach((listener) => listener(state));\n  };\n\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => {\n      listeners.delete(listener);\n    };\n  };\n\n  const actions = {};\n  for (const [key, action] of Object.entries(initializeStore(state))) {\n    if (typeof action === \"function\") {\n      actions[key] = (...args) => {\n        const updater = action(...args);\n        const newState = updater(state);\n        setState(newState);\n      };\n    }\n  }\n\n  return (selector = getState) => {\n    const [currentState, setCurrentState] = useState(selector(getState()));\n\n    useEffect(() => {\n      const listener = (newState) => {\n        const selectedState = selector(newState);\n        if (!shallowEqual(currentState, selectedState)) {\n          // Update state only if it has changed\n          setCurrentState(selectedState);\n        }\n      };\n\n      // Subscribe to the store\n      const unsubscribe = subscribe(listener);\n\n      // Clean up subscription\n      return () => {\n        unsubscribe();\n      };\n    }, [selector]);\n\n    return { ...currentState, ...actions };\n  };\n};\n"],"names":["shallowEqual","objA","objB","key","hasOwnProperty","deepMerge","target","source","result","_extends","initializeStore","middleware","state","listeners","Set","stateInitializer","getState","undefined","setState","newState","updatedState","forEach","listener","actions","_loop","_Object$entries$_i","_Object$entries","_i","action","apply","slice","call","arguments","updater","Object","entries","length","selector","_useState","useState","currentState","setCurrentState","useEffect","unsubscribe","add","selectedState"],"mappings":"2PAAO,IAAMA,EAAe,SAACC,EAAMC,GACjC,GAAID,IAASC,EAAM,OAAO,EAC1B,GACkB,iBAATD,GACE,OAATA,GACgB,iBAATC,GACE,OAATA,EAEA,SAGF,IAAK,IAAMC,KAAOF,EAChB,GAAIA,EAAKG,eAAeD,MACjBD,EAAKE,eAAeD,IAAQF,EAAKE,KAASD,EAAKC,IAClD,OACF,EAIJ,IAAK,IAAMA,KAAOD,EAChB,GAAIA,EAAKE,eAAeD,KAASF,EAAKG,eAAeD,GACnD,OACF,EAGF,OAAO,CACT,EAEaE,EAAY,SAAZA,EAAaC,EAAQC,GAChC,IAAMC,EAAMC,EAAQH,GAAAA,GACpB,IAAK,IAAMH,KAAOI,EAEdC,EAAOL,GADkB,iBAAhBI,EAAOJ,IAAqC,OAAhBI,EAAOJ,GAC9BE,EAAUC,EAAOH,IAAQ,GAAII,EAAOJ,IAEpCI,EAAOJ,GAGzB,OAAOK,CACT,sBCnC2B,SAACE,EAAiBC,GA4B3C,IA3BA,IAAIC,EAAQF,EAAgB,MACxBG,EAAY,IAAIC,IAChBC,EAAmBL,EAEjBM,EAAW,WAKf,YAJcC,IAAVL,IACFA,EAAQG,EAAiB,MACzBA,EAAmB,MAEdH,CACT,EAEMM,EAAW,SAACC,GAChB,IAAMC,EAAef,EAAUO,EAAOO,GAClCnB,EAAaY,EAAOQ,KACxBR,EAAQQ,EACRP,EAAUQ,QAAQ,SAACC,UAAaA,EAASV,EAAM,GACjD,EASMW,EAAU,CAAA,EAAGC,EAAA,WACd,IAAAC,EAAAC,EAAAC,GAAYC,EAAMH,KACC,mBAAXG,IACTL,EAFWE,EAAA,IAEI,WACb,IACMN,EADUS,EAAMC,WAAA,EAAA,GAAAC,MAAAC,KAAAC,WACLC,CAAQrB,GACzBM,EAASC,EACX,EAEJ,EARAQ,IAAAD,EAA4BQ,OAAOC,QAAQzB,EAAgBE,IAAOe,EAAAD,EAAAU,OAAAT,IAAAH,IAUlE,gBAAQa,QAAQ,IAARA,IAAAA,EAAWrB,GACjB,IAAAsB,EAAwCC,EAAQA,SAACF,EAASrB,MAAnDwB,EAAYF,EAAA,GAAEG,EAAeH,KAoBpC,OAlBAI,EAAAA,UAAU,WACR,IAtBepB,EA+BTqB,GA9BR9B,EAAU+B,IADOtB,EAsBE,SAACH,GAChB,IAAM0B,EAAgBR,EAASlB,GAC1BnB,EAAawC,EAAcK,IAE9BJ,EAAgBI,EAEpB,GA1BW,WACXhC,EAAgB,OAACS,EACnB,GA8BE,OAAa,WACXqB,GACF,CACF,EAAG,CAACN,IAEJ5B,EAAY+B,CAAAA,EAAAA,EAAiBjB,EAC/B,CACF"}