import{useRef as n,useReducer as t,useEffect as r,useState as e}from"react";import{jsx as o,Fragment as i}from"react/jsx-runtime";function u(){return u=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}return n},u.apply(this,arguments)}var c=function n(t,r){var e=u({},t);for(var o in r)e[o]="object"==typeof r[o]&&null!==r[o]?n(t[o]||{},r[o]):r[o];return e},f=function(e,o){void 0===o&&(o=[]);for(var i=e({}),f=new Set,a=e,s=function(){return void 0===i&&(i=a(null),a=null),i},l=function(n){var t=c(i,n);(function(n,t){if(n===t)return!0;if("object"!=typeof n||null===n||"object"!=typeof t||null===t)return!1;for(var r in n)if(n.hasOwnProperty(r)&&(!t.hasOwnProperty(r)||n[r]!==t[r]))return!1;for(var e in t)if(t.hasOwnProperty(e)&&!n.hasOwnProperty(e))return!1;return!0})(i,t)||(i=t,f.forEach(function(n){return n(i)}))},p=function(n){return f.add(n),function(){f.delete(n)}},v={},d=function(){var n=w[y],t=n[1];"function"==typeof t&&(v[n[0]]=function(){var n=t.apply(void 0,[].slice.call(arguments))(i);l(n)})},y=0,w=Object.entries(e(i));y<w.length;y++)d();return o.forEach(function(n){return n({getState:s,setState:l,subscribe:p})}),function(e){void 0===e&&(e=s);var o=n(e(i)),c=t(function(n){return n+1},0)[1];return r(function(){var n=p(function(n){var t=e(n);o.current!==t&&(o.current=t,c())});return function(){n()}},[e]),u({},o.current,v,{getState:s,setState:l,subscribe:p})}},a=function(n){var t=null;return function(r){(t=new BroadcastChannel(n)).onmessage=function(n){var t=n.data,e=t.payload;"STATE_UPDATE"===t.type&&e&&"object"==typeof e&&r.setState(e)};var e=r.subscribe(function(n){!function(n){var r=Object.fromEntries(Object.entries(n).filter(function(n){return"function"!=typeof n[1]}));t&&t.postMessage({type:"STATE_UPDATE",payload:r})}(n)});return function(){t&&t.close(),e()}}},s=function(n){var t=n.children,u=e(!1),c=u[0],f=u[1];return r(function(){f(!0)},[]),/*#__PURE__*/o(i,{children:c?/*#__PURE__*/o("div",{children:t}):null})},l=function(){return function(n){var t=n.getState(),r=n.subscribe(function(n){console.log("Previous State:",t),console.log("New State:",n)});return function(){r()}}},p=function(n,t,r){return function(e){var o=function(){try{if("undefined"!=typeof window){var r=window[n].getItem(t);if(r)return JSON.parse(r)}}catch(n){console.error("Error while loading persisted state:",n)}}();if(e.setState(o||e.getState()),"undefined"!=typeof window)try{return e.subscribe(function(e){!function(e){try{if("undefined"!=typeof window&&window[n]){var o={};r.forEach(function(n){o[n]=e[n]});var i=JSON.stringify(o);window[n].setItem(t,i)}}catch(n){console.error("Error while persisting state:",n)}}(e)})}catch(n){}}};export{s as HydrateState,a as channelBroadcast,f as createStore,l as logging,p as preserve};
//# sourceMappingURL=index.esm.js.map
